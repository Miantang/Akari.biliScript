/* Sample: XarpleFontCharacterAnimation
 * Sample demonstrating usage of Xarple's vector font format. A rip off the original CharacterAnimation.
 */

var Akari = Global._get( "__akari" );

Akari.Utilities.Factory.extend( this, Akari.Utilities );
Factory.extend( this, Akari.Display );
Factory.extend( this, Akari.Display.Text );
Factory.extend( this, Akari.Animation );

// Times New Roman, "Lorem ipsum dolor sit amet consectetuer adipiscing elit"
var tnrFontData =
{
  size: 72,
  underlinePosition: 89.2656,
  underlineThickness: 0.78125,
  width: 192,
  height: 110,
  glyphCount: 17,
  'L':
  {
    advanceHori: 57,
    commands: $.toIntVector([1,2,2,2,2,2,3,3,2,3,3,2,2,2,2,3,3,3,2,3,3,3,2,3,3,3]),
    paths: $.toNumberVector([53,68,55,68.3125,50,85,1,85,1,84,3.35938,84,7.32813,84,9.03125,81.25,10,79.6875,10,74,10,32,10,25.75,8.70313,24.1719,6.90625,22,3.35938,22,1,22,1,21,30,21,30,22,24.7656,21.9531,22.6563,22.8906,20.5469,23.8125,19.7656,25.2344,19,26.6406,19,32,19,74.2969,19,78.4219,19.7344,79.9688,20.2813,81,21.4219,81.5,22.5625,82,28.5313,82,33.0313,82,40.1406,82,43.0156,80.8906,45.8906,79.7656,48.25,76.9375,50.625,74.1094,53,68]),
    kernings: {}
  },
  'o':
  {
    advanceHori: 48,
    commands: $.toIntVector([1,3,3,3,3,3,3,3,3,3,3,1,3,3,3,3,3,3,3,3,3]),
    paths: $.toNumberVector([23.5469,41,33.1875,41,39.0313,48.3281,44,54.5781,44,62.6875,44,68.3906,41.2656,74.2344,38.5313,80.0625,33.7188,83.0313,28.9219,86,23.0313,86,13.4375,86,7.78125,78.3594,3,71.9063,3,63.8906,3,58.0469,5.89063,52.2813,8.79688,46.5156,13.5313,43.7656,18.2656,41,23.5469,41,22.0313,44,19.4531,44,16.8281,45.4688,14.2188,46.9375,12.6094,50.6406,11,54.3281,11,60.1094,11,69.4531,14.875,76.2344,18.7656,83,25.1094,83,29.8438,83,32.9219,79.2656,36,75.5313,36,66.4219,36,55.0156,30.875,48.4844,27.4063,44,22.0313,44]),
    kernings: {}
  },
  'r':
  {
    advanceHori: 32,
    commands: $.toIntVector([1,2,3,3,3,3,3,3,3,3,3,2,3,3,3,2,2,2,3,3,3,2,3,3,3,3,2,2]),
    paths: $.toNumberVector([15,41,15,52.0938,20.3906,41,26.0469,41,28.625,41,30.3125,42.8125,32,44.6094,32,46.9844,32,49.0938,30.8594,50.5469,29.7344,52,28.1719,52,26.6563,52,24.5469,50,22.4375,48,21.4219,48,20.5469,48,19.5156,49.0156,17.3281,51.0938,15,55.8438,15,75,15,78.625,15.9531,80.4844,16.5938,81.7813,18.25,82.8906,19.9063,84,23,84,23,85,1,85,1,84,3.92188,84,5.32813,82.8281,6.375,81.9844,6.79688,80.1406,7,79.2344,7,75,7,59,7,50.7969,6.75,49.2344,6.5,47.6719,5.8125,46.9844,5.125,46.2969,4.10938,46.2969,2.90625,46.2969,1.39063,47,1,46,13.1563,41]),
    kernings: {}
  },
  'e':
  {
    advanceHori: 43,
    commands: $.toIntVector([1,3,3,3,3,2,3,3,3,3,3,3,3,3,1,2,3,3,3,3,3]),
    paths: $.toNumberVector([10,58,9.95313,67.3594,14.6094,72.6719,19.25,78,25.5313,78,29.7188,78,32.8125,76,35.9063,73.9844,38,68,39,68.9063,38.0313,75.875,33.3281,80.9375,28.6406,86,21.5781,86,13.9219,86,8.45313,80.0625,3,74.1094,3,64.0625,3,53.1719,8.59375,47.0938,14.1875,41,22.6563,41,29.7969,41,34.3906,45.625,39,50.25,39,58,10,55,29,55,28.7813,51.0313,28.0625,49.4063,26.9375,46.8906,24.7188,45.4531,22.5,44,20.0781,44,16.3594,44,13.4219,46.9063,10.5,49.8125,10,55]),
    kernings: {}
  },
  'm':
  {
    advanceHori: 75,
    commands: $.toIntVector([1,3,3,3,3,3,3,3,3,3,3,2,3,3,3,2,2,2,2,3,3,3,2,3,3,3,3,2,2,2,3,3,3,2,2,2,3,3,3,2,3,3,3,3,2,3,3,3,2,2,2,3,3,3,2,3,3,3,3,2,2,2]),
    paths: $.toNumberVector([15,50.4688,19.6875,45.6094,20.5313,44.8906,22.6406,43.0469,25.0781,42.0313,27.5156,41,29.9219,41,33.9531,41,36.8594,43.4375,39.7656,45.8594,40.75,50.4688,45.5625,44.6406,48.8906,42.8281,52.2188,41,55.7188,41,59.1406,41,61.7813,42.7344,64.4219,44.4688,65.9688,48.3906,67,51.0781,67,56.7969,67,75,67,79.5313,67.5625,81.2031,68,82.375,69.1719,83.1875,70.3438,84,73,84,73,85,53,85,53,84,53.7656,84,56.1563,84,57.5,82.7969,58.4375,81.9531,58.8438,80.1094,59,79.2031,59,75,59,57.0938,59,52,57.75,49.9063,55.9531,47,51.9844,47,49.5313,47,47.0625,48.2188,44.5938,49.4375,41.0938,52.7656,41,53.2813,41,55.2344,41,75,41,79.9531,41.4219,81.1719,41.8438,82.375,43.0156,83.1875,44.1875,84,47,84,47,85,27,85,27,84,30.0625,84,31.2031,83.0625,32.3594,82.1094,32.7969,80.2031,33,79.3125,33,75,33,57.1563,33,52.0781,31.4844,49.875,29.4531,47,25.8125,47,23.3281,47,20.8906,48.3125,17.0781,50.2813,15,52.7656,15,75,15,79.7344,15.5,81.1563,16,82.5781,16.9844,83.2969,17.9844,84,21,84,21,85,1,85,1,84,3.71875,84,4.79688,83.2969,5.875,82.5781,6.4375,81.0313,7,79.4688,7,75,7,59,7,51.3906,6.65625,49.1719,6.375,47.5,5.78125,46.9063,5.20313,46.2969,4.1875,46.2969,3.10938,46.2969,1.57813,47,1,46,13.1094,41,15,41]),
    kernings: {}
  },
  ' ':
  {
    advanceHori: 24,
    commands: null,
    paths: null,
    kernings: {}
  },
  'i':
  {
    advanceHori: 27,
    commands: $.toIntVector([1,3,3,3,3,3,3,3,3,1,2,3,3,3,2,2,2,3,3,3,2,3,3,3,3,2,2]),
    paths: $.toNumberVector([13.5313,18,15.7969,18,17.3906,19.6094,19,21.2031,19,23.4688,19,25.75,17.3906,27.375,15.7969,29,13.5313,29,11.25,29,9.625,27.375,8,25.75,8,23.4688,8,21.2031,9.59375,19.6094,11.2031,18,13.5313,18,18,41,18,75,18,79.5313,18.5313,81.0313,19.0781,82.5313,20.125,83.2656,21.1875,84,24,84,24,85,4,85,4,84,6.875,84,7.85938,83.3125,8.84375,82.625,9.42188,81.0469,10,79.4688,10,75,10,59,10,51.3906,9.65625,49.1406,9.375,47.5156,8.78125,46.9063,8.20313,46.2969,7.1875,46.2969,6.10938,46.2969,4.54688,47,4,46,16.0781,41]),
    kernings: {}
  },
  'p':
  {
    advanceHori: 48,
    commands: $.toIntVector([1,2,2,2,3,3,3,3,3,3,3,3,2,3,3,3,2,2,2,2,3,3,3,2,3,3,3,3,1,2,3,3,3,3,3,3,3,3,3]),
    paths: $.toNumberVector([1,46,13.3438,41,15,41,15,51.3281,18.3438,45.5938,21.7188,43.2969,25.0938,41,28.8281,41,35.3281,41,39.6719,46,45,52.125,45,61.9531,45,72.9375,38.5781,80.1094,33.2969,86,25.2813,86,21.7969,86,19.25,84.9688,17.3594,84.25,15,82.0469,15,96,15,100.828,15.4375,102.141,15.8906,103.453,16.9844,104.219,18.0938,105,21,105,21,106,-0.984375,106,-0.984375,105,0.265625,105,3.03125,105.047,4.98438,103.953,5.9375,103.406,6.46875,102.188,7,100.969,7,96,7,54,7,49.7656,6.6875,48.625,6.375,47.4688,5.6875,46.9063,5.01563,46.3438,3.84375,46.3438,2.90625,46.3438,1.46875,47,15,54.0313,15,69.6563,15,74.7344,15.4375,76.3281,16.1094,78.9844,18.7188,81,21.3438,83,25.3281,83,30.125,83,33.1094,79.4375,37,74.7813,37,66.3281,37,56.7344,32.5781,51.5625,29.5,48,25.2813,48,22.9688,48,20.7188,49.0938,18.9844,49.9219,15,54.0313]),
    kernings: {}
  },
  's':
  {
    advanceHori: 37,
    commands: $.toIntVector([1,2,2,3,3,3,3,3,3,2,3,3,3,3,3,3,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3]),
    paths: $.toNumberVector([31,41,31,56,30,56,28.2188,49.0313,25.4219,46.5156,22.6406,44,18.3125,44,15.0313,44,13.0156,45.7031,11,47.3906,11,49.4375,11,52,12.2188,53.8281,13.3906,55.7031,17.7969,57.7969,24.5781,61.0469,34,65.625,34,73.125,34,78.9219,29.5,82.4688,25,86,19.4219,86,15.4219,86,10.2813,84.5,8.71875,84,7.71875,84,6.625,84,6,86,5,86,5,71,6,71,7.34375,76.9531,11.1094,79.9844,14.875,83,19.5469,83,22.8438,83,24.9219,81.1094,27,79.2188,27,76.5469,27,73.3125,24.875,71.125,22.7656,68.9219,16.0156,65.7031,9.26563,62.4688,7.14063,59.7969,5,57.1875,5,53.1875,5,47.9844,8.70313,44.5,12.4063,41,18.2813,41,20.875,41,24.5469,42.2031,26.9844,43,27.7969,43,28.5625,43,28.9844,42.6406,29.4219,42.2656,30,41]),
    kernings: {}
  },
  'u':
  {
    advanceHori: 48,
    commands: $.toIntVector([1,2,3,3,3,3,2,2,2,2,3,3,3,3,3,2,3,3,3,2,2,2,3,3,3,3,2,3,3,2]),
    paths: $.toNumberVector([41,42,41,68,41,75.9219,41.2813,77.6875,41.5781,79.4531,42.2188,80.125,42.875,80.7969,43.7344,80.7969,44.9375,80.7969,46.4531,80,47,81,34.9688,86,33,86,33,76.7188,27.375,82.8438,24.4063,84.4219,21.4531,86,18.1563,86,14.4844,86,11.7813,83.9063,9.09375,81.8125,8.04688,78.5313,7,75.2344,7,69.2188,7,50,7,46.7656,6.45313,45.5313,5.92188,44.2969,4.84375,43.625,3.78125,42.9531,1,43,1,42,15,42,15,70.375,15,76.2969,17.1094,78.1563,19.2344,80,22.2188,80,24.2656,80,26.8438,78.75,29.4375,77.5,33,73.9844,33,50,33,45.9531,31.8281,44.5313,30.6719,43.1094,27,43,27,42]),
    kernings: {}
  },
  'd':
  {
    advanceHori: 48,
    commands: $.toIntVector([1,3,3,3,3,3,3,3,2,3,3,3,3,2,2,2,2,3,3,3,3,2,2,2,1,2,3,3,3,3,3,3,3,3]),
    paths: $.toNumberVector([33,78.5625,29.875,82.7656,26.8906,84.3906,23.9063,86,20.4531,86,13.4531,86,8.21875,80.1875,3,74.375,3,65.2656,3,56.1406,8.78125,48.5781,14.5781,41,23.6719,41,29.3125,41,33,45.1719,33,36,33,28.1094,32.7031,26.3125,32.4063,24.5,31.7813,23.875,31.1563,23.25,30.2188,23.25,29.2031,23.25,27.5156,24,27,23,39.0156,18,41,18,41,68,41,75.9531,41.2969,77.7031,41.5938,79.4531,42.2344,80.125,42.875,80.7969,43.75,80.7969,44.7969,80.7969,46.5625,80,47,81,35.0313,86,33,86,33,75.4063,33,55.1719,32.7188,51.6094,31.2813,49.0938,29.8438,46.5625,27.4688,45.2813,25.1094,44,22.8594,44,18.6563,44,15.3594,47.5625,11,52.2344,11,61.2344,11,70.3281,15.2031,75.1719,19.4219,80,24.5781,80,28.9375,80,33,75.4063]),
    kernings: {}
  },
  'l':
  {
    advanceHori: 27,
    commands: $.toIntVector([1,2,3,3,3,2,2,2,3,3,3,2,3,3,3,3,2,2]),
    paths: $.toNumberVector([18,18,18,75,18,79.5313,18.5,81,19.0156,82.4688,20.0625,83.2344,21.125,84,24,84,24,85,4,85,4,84,6.79688,84,7.8125,83.3125,8.84375,82.625,9.42188,81.0469,10,79.4688,10,75,10,36,10,28.125,9.71875,26.3281,9.45313,24.5156,8.82813,23.8906,8.21875,23.25,7.28125,23.25,6.25,23.25,4.67188,24,4,23,16.0156,18]),
    kernings: {}
  },
  't':
  {
    advanceHori: 27,
    commands: $.toIntVector([1,2,2,2,2,2,3,3,3,3,2,3,3,3,3,3,2,2,2,3,3,3]),
    paths: $.toNumberVector([15,28,15,42,25.0313,42,25.0313,45,15,45,15,72.9063,15,77.0938,16.25,78.5469,17.5156,80,19.4844,80,21.1094,80,22.625,79.25,24.1563,78.4844,25,77,27,77,25.2813,81.4844,22.125,83.75,18.9844,86,15.6563,86,13.3906,86,11.2188,84.7969,9.0625,83.5781,8.03125,81.3125,7,79.0469,7,74.3281,7,45,0,45,0,43.5781,2.6875,42.5781,5.5,40.2031,8.3125,37.8125,10.6563,34.4688,11.8594,32.7031,14,28]),
    kernings: {}
  },
  'a':
  {
    advanceHori: 43,
    commands: $.toIntVector([1,3,3,3,3,3,3,3,2,3,3,3,3,2,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,2,3,3,3,1,2,3,3,3,3,3,3]),
    paths: $.toNumberVector([27,78.4375,20.3594,83.8906,18.6719,84.75,16.125,86,13.2656,86,8.78125,86,5.89063,83,3,79.9844,3,75.0625,3,71.9688,4.40625,69.6875,6.34375,66.5469,11.1094,63.7656,15.8906,60.9844,27,57,27,55.2969,27,48.8281,25,46.4219,23.0156,44,19.2188,44,16.3438,44,14.6406,45.6563,12.9063,47.3281,12.9063,49.4688,13,52.3125,13,54.5625,11.8906,55.7813,10.7813,57,8.96875,57,7.21875,57,6.10938,55.7344,5,54.4531,5,52.25,5,48.0469,9.125,44.5313,13.25,41,20.7031,41,26.4219,41,30.0781,42.9219,32.8438,44.3594,34.1563,47.4531,35,49.4531,35,55.6719,35,70.1875,35,76.3125,35.2188,77.6875,35.4531,79.0625,35.9531,79.5313,36.4688,80,37.1406,80,37.8594,80,38.3906,79.7344,39.3281,79.25,42,77,42,79.0938,36.7813,86,32.0313,86,29.75,86,28.3906,84.2969,27.0469,82.5781,27,78.4375,27,75.5469,27,60,19.9375,62.6719,17.875,63.7813,14.1875,65.75,12.5938,67.8906,11,70.0156,11,72.5625,11,75.7656,13,77.8906,15.0156,80,17.6406,80,21.2031,80,27,75.5469]),
    kernings: {}
  },
  'c':
  {
    advanceHori: 43,
    commands: $.toIntVector([1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]),
    paths: $.toNumberVector([39,67.6563,37.2813,76.9844,32.2344,81.5,27.2031,86,21.0938,86,13.8125,86,8.40625,79.9375,3,73.8594,3,63.5156,3,53.5156,8.85938,47.2656,14.7188,41,22.9219,41,29.0625,41,33.0313,44.2813,37,47.5625,37,51.0938,37,52.8438,35.9063,53.9219,34.8125,55,32.8594,55,30.2344,55,29.3906,53.25,28.1406,52.2656,27.8906,49.5469,27.6563,46.8125,26.0938,45.3906,24.5313,44,21.7813,44,17.3281,44,14.6094,47.3594,11,51.8125,11,59.1406,11,66.5938,14.7344,72.2969,18.4844,78,24.8438,78,29.4063,78,33.0313,75.3438,35.5781,73.1875,38,67]),
    kernings: {}
  },
  'n':
  {
    advanceHori: 48,
    commands: $.toIntVector([1,3,3,3,3,2,3,3,3,2,2,2,2,3,3,3,2,3,3,3,2,3,3,3,2,2,2,2,3,3,2,3,3,3,3,2,2,2]),
    paths: $.toNumberVector([15,50.2969,22.6875,41,29.6719,41,33.25,41,35.8281,42.7344,38.4219,44.4688,39.9531,48.4375,41,51.2031,41,56.9375,41,75,41,79.5781,41.5938,81.2031,42.0781,82.5313,43.125,83.2656,44.1719,84,47,84,47,85,27,85,27,84,27.7656,84,30.3594,84,31.3906,82.9844,32.4375,81.9531,32.8438,79.9531,33,79.1563,33,75,33,57.875,33,52.1563,31.4531,49.5781,29.9063,47,26.25,47,20.6094,47,15,53.0313,15,75,15,79.8906,15.4375,81.0469,16,82.5781,16.9844,83.2969,17.9844,84,21,84,21,85,1,85,1,84,1.85938,84,4.89063,84,5.9375,82.1406,7,80.2656,7,75,7,59,7,51.0156,6.70313,49.2813,6.42188,47.5313,5.8125,46.9219,5.20313,46.2969,4.1875,46.2969,3.10938,46.2969,1.57813,47,1,46,13.1094,41,15,41]),
    kernings: {}
  },
  'g':
  {
    advanceHori: 47,
    commands: $.toIntVector([1,3,3,3,3,3,2,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,3,3,3,3,3,3,3,1,3,3,3,3,3,3,3,3,3]),
    paths: $.toNumberVector([14.1875,69.4063,10.2344,67.5,8.10938,64.0781,6,60.6406,6,56.4844,6,50.1406,10.8125,45.5781,15.625,41,23.1406,41,29.2813,41,33.7969,44,42.9063,44,44.9219,44,45.25,44.0938,45.5781,44.1719,45.7188,44.3594,46,44.6719,46,45.4375,46,46.2969,45.7656,46.6406,45.625,46.7969,45.2813,46.9063,44.9375,47,42.9375,47,37.375,47,40,50.5,40,55.9375,40,62.1563,35.3906,66.5781,30.7813,71,23.0156,71,19.8281,71,16.4844,70.1875,13.8594,71.9219,12.9219,73.2344,12,74.5313,12,75.4375,12,76.2188,12.7813,76.9531,13.5781,77.6875,15.8594,78,17.2031,78.1875,22.5313,78.3281,32.3594,78.5781,35.2656,79,39.7031,79.625,42.3438,82.2969,45,84.9688,45,88.8906,45,94.2969,40.125,99.0156,32.9531,106,21.4219,106,12.5625,106,6.45313,101.859,3,99.4844,3,96.9219,3,95.7813,3.48438,94.6406,4.21875,92.875,6.54688,89.75,6.85938,89.3125,11.0156,84.6094,8.26563,83.1563,7.125,82.0156,6,80.875,6,79.4375,6,77.7969,7.45313,75.6094,8.92188,73.4219,14.1875,69.4063,22.375,43,18.8125,43,16.4063,45.7813,14,48.5625,14,54.3281,14,61.7813,17.2656,65.8906,19.7813,69,23.625,69,27.2813,69,29.6406,66.3125,32,63.625,32,57.8594,32,50.3594,28.6719,46.1094,26.2188,43,22.375,43,13.5469,85,11.2969,87.375,10.1406,89.4219,9,91.4688,9,93.2031,9,95.4375,11.7344,97.1094,16.4688,100,25.4063,100,33.9219,100,37.9531,97.0156,42,94.0469,42,90.6875,42,88.25,39.5938,87.2188,37.1406,86.1875,29.875,86,19.25,85.7344,13.5469,85]),
    kernings: {}
  }
};

var mainComp = MainComposition(
{
  width : 640,
  height : 480,

  layers :
  [
    DynamicVectorTextLayer(
    {
      font : tnrFontData,

      textProperties :
      {
        horizontalAlign : "center",
        verticalAlign : "center",
        fontSize : 14,
        text : KeyframesBind(
        {
          keyframes :
          [
            Keyframe({ time : 0, value : "Lorem ipsum dolor sit amet\nconsectetuer adipiscing elit", interpolation : Interpolation.hold }),
            Keyframe({ time : 30000, value : "tile gnicsipida reutetcesnoc\ntema tis rolod muspi meroL", interpolation : Interpolation.hold })
          ]
        }),

        letterSpacing : KeyframesBind(
        {
          keyframes :
          [
            Keyframe({ time : 0, value : 0 }),
            Keyframe({ time : 30000, value : 20 }),
            Keyframe({ time : 60000, value : 0 })
          ]
        })
      },

      inPoint : 0,
      outPoint : 60000,

      properties : 
      {
        x : 320,
        y : 240
      },

      animators :
      [
        Animator(
        {
          selector : RangeSelector(
          {
            shapingFunc : RangeShape.triangle,
            properties :
            {
              start : 0,
              end : 4,

              // Playing with offset to have the triangle "pass through" the string.
              offset : KeyframesBind(
              {
                keyframes :
                [
                  Keyframe({ time : 0, value : 1 }),
                  Keyframe({ time : 60000, value : -4 })
                ]
              })
            }
          }),
          bindings :
          {
            x : 100,
            y : -100,
            z : 250,

            rotationX : 1440,
            rotationY : -720,
            rotationZ : 360
          }
        })
      ]
    })
  ]
});

Akari.execute( mainComp );