/* Sample: XarpleFontCharacterAnimation
 * Sample demonstrating usage of Xarple's vector font format. A rip off the original CharacterAnimation.
 */

var Akari = Global._get( "__akari" );

Akari.Utilities.Factory.extend( this, Akari.Utilities );
Factory.extend( this, Akari.Display );
Factory.extend( this, Akari.Display.Text );
Factory.extend( this, Akari.Animation );

// Times New Roman, "Lorem ipsum dolor sit amet consectetuer adipiscing elit"
var tnrFontData =
{
  size: 14,
  underlinePosition: 20.2656,
  underlineThickness: 0.78125,
  height: 21,
  glyphCount: 17,
  'L':
  {
    advanceHori: 11,
    commands: $.toIntVector([1,2,2,2,2,2,3,3,2,3,3,2,2,2,2,3,3,3,2,3,3,3,2,3,3,3]),
    paths: $.toNumberVector([10,12,11,12.0781,10,16,0,16,0,15,0.515625,15,1.40625,15,1.78125,14.7188,2,14.5625,2,14,2,6,2,5.375,1.71875,5.21875,1.3125,5,0.515625,5,0,5,0,4,6,4,6,5,5.04688,4.98438,4.65625,5.09375,4.28125,5.1875,4.14063,5.32813,4,5.46875,4,6,4,13.6094,4,14.3594,4.125,14.6406,4.21875,14.8281,4.42188,14.9219,4.625,15,5.6875,15,6.48438,15,7.73438,15,8.23438,14.7656,8.75,14.5156,9.28125,13.9219,9.82813,13.3125,10,12]),
    kernings: {}
  },
  'o':
  {
    advanceHori: 10,
    commands: $.toIntVector([1,3,3,3,3,3,3,3,3,3,3,1,3,3,3,3,3,3,3,3,3]),
    paths: $.toNumberVector([5.01563,7,6.89063,7,8.03125,8.46875,9,9.71875,9,11.3438,9,12.4844,8.46875,13.6563,7.9375,14.8125,7,15.4063,6.0625,16,4.90625,16,3.03125,16,1.9375,14.4688,1,13.1875,1,11.5781,1,10.4063,1.5625,9.26563,2.125,8.10938,3.04688,7.5625,3.98438,7,5.01563,7,4.76563,8,4.35938,8,3.9375,8.26563,3.51563,8.53125,3.25,9.20313,3,9.85938,3,10.8906,3,12.5625,3.5625,13.7813,4.125,15,5.26563,15,6.01563,15,6.5,14.3281,7,13.6563,7,12.0313,7,9.98438,6.1875,8.8125,5.625,8,4.76563,8]),
    kernings: {}
  },
  'r':
  {
    advanceHori: 6,
    commands: $.toIntVector([1,2,3,3,3,3,3,3,3,3,3,2,3,3,3,2,2,2,3,3,3,2,3,3,3,3,2,2]),
    paths: $.toNumberVector([3,7,3,9.01563,3.95313,7,4.95313,7,5.40625,7,5.70313,7.32813,6,7.65625,6,8.09375,6,8.46875,5.79688,8.73438,5.60938,9,5.32813,9,5.0625,9,4.6875,8.5,4.3125,8,4.125,8,3.98438,8,3.79688,8.23438,3.40625,8.71875,3,9.8125,3,13,3,14.2344,3.125,14.875,3.20313,15.3125,3.40625,15.1563,3.60938,15,4,15,4,16,0,16,0,15,0.484375,15,0.71875,14.7344,0.890625,14.5469,0.96875,14.1406,1,13.9375,1,13,1,11,1,9.625,0.953125,9.375,0.921875,9.10938,0.796875,8.98438,0.6875,8.85938,0.515625,8.85938,0.3125,8.85938,0.0625,9,0,8,2.60938,7]),
    kernings: {}
  },
  'e':
  {
    advanceHori: 8,
    commands: $.toIntVector([1,3,3,3,3,2,3,3,3,3,3,3,3,3,1,2,3,3,3,3,3]),
    paths: $.toNumberVector([3,11,3,12.4063,3.65625,13.2031,4.32813,14,5.21875,14,5.8125,14,6.25,14.0313,6.70313,14.0469,7,13,8,13.0938,7.3125,14.6875,6.39063,15.3438,5.48438,16,4.60938,16,3.125,16,2.0625,14.8125,1,13.625,1,11.6094,1,9.4375,2.07813,8.21875,3.17188,7,4.82813,7,6.21875,7,7.10938,8.09375,8,9.17188,8,11,3,10,6,10,5.96875,9.28125,5.84375,8.98438,5.67188,8.53125,5.3125,8.26563,4.96875,8,4.59375,8,4,8,3.53125,8.53125,3.07813,9.0625,3,10]),
    kernings: {}
  },
  'm':
  {
    advanceHori: 14,
    commands: $.toIntVector([1,3,3,3,3,3,3,3,3,3,3,2,3,3,3,2,2,2,2,3,3,3,2,3,3,3,3,2,2,2,3,3,3,2,2,2,3,3,3,2,3,3,3,3,2,3,3,3,2,2,2,3,3,3,2,3,3,3,3,2,2,2]),
    paths: $.toNumberVector([3,8.73438,3.90625,7.84375,4.0625,7.71875,4.46875,7.375,4.9375,7.1875,5.40625,7,5.85938,7,6.64063,7,7.1875,7.45313,7.75,7.89063,7.9375,8.73438,8.85938,7.67188,9.5,7.34375,10.1406,7,10.8281,7,11.4844,7,11.9844,7.3125,12.5,7.60938,12.7969,8.29688,13,8.78125,13,9.78125,13,13,13,14,13.0938,14.375,13.1719,14.6406,13.3594,14.8281,13.5625,15,14,15,14,16,10,16,10,15,10.125,15,10.5313,15,10.75,14.7344,10.9063,14.5469,10.9688,14.1406,11,13.9375,11,13,11,9.79688,11,8.89063,10.7969,8.51563,10.5,8,9.82813,8,9.42188,8,9,8.26563,8.59375,8.51563,8.01563,9.21875,8,9.32813,8,9.65625,8,13,8,14.0938,8.0625,14.375,8.14063,14.6406,8.32813,14.8281,8.53125,15,9,15,9,16,5,16,5,15,5.51563,15,5.70313,14.7969,5.89063,14.5781,5.96875,14.1563,6,13.9531,6,13,6,9.9375,6,9.0625,5.75,8.60938,5.40625,8,4.79688,8,4.39063,8,3.98438,8.28125,3.34375,8.6875,3,9.21875,3,13,3,14.0469,3.07813,14.375,3.17188,14.6875,3.32813,14.8438,3.5,15,4,15,4,16,0,16,0,15,0.453125,15,0.625,14.8438,0.8125,14.6875,0.90625,14.3438,1,14,1,13,1,11,1,9.73438,0.9375,9.35938,0.890625,9.07813,0.796875,8.96875,0.703125,8.85938,0.53125,8.85938,0.34375,8.85938,0.09375,9,0,8,2.59375,7,3,7]),
    kernings: {}
  },
  ' ':
  {
    advanceHori: 5,
    commands: null,
    paths: null,
    kernings: {}
  },
  'i':
  {
    advanceHori: 4,
    commands: $.toIntVector([1,3,3,3,3,3,3,3,3,1,2,3,3,3,2,2,2,3,3,3,2,3,3,3,3,2,2]),
    paths: $.toNumberVector([2,3,2.42188,3,2.70313,3.29688,3,3.57813,3,4,3,4.40625,2.70313,4.70313,2.42188,5,2,5,1.59375,5,1.29688,4.70313,1,4.40625,1,4,1,3.57813,1.28125,3.29688,1.57813,3,2,3,3,7,3,13,3,14,3.09375,14.3438,3.1875,14.6719,3.35938,14.8438,3.53125,15,4,15,4,16,0,16,0,15,0.484375,15,0.640625,14.8594,0.8125,14.7031,0.90625,14.3594,1,14,1,13,1,11,1,9.73438,0.9375,9.35938,0.890625,9.07813,0.796875,8.96875,0.703125,8.85938,0.53125,8.85938,0.34375,8.85938,0.09375,9,0,8,2.59375,7]),
    kernings: {}
  },
  'p':
  {
    advanceHori: 10,
    commands: $.toIntVector([1,2,2,2,3,3,3,3,3,3,3,3,2,3,3,3,2,2,2,2,3,3,3,2,3,3,3,3,1,2,3,3,3,3,3,3,3,3,3]),
    paths: $.toNumberVector([0,8,2.64063,7,3,7,3,8.67188,3.67188,7.75,4.34375,7.375,5.01563,7,5.76563,7,6.6875,7,7.9375,8,9,9.21875,9,11.1875,9,13.3906,7.71875,14.8281,6.65625,16,5.0625,16,4.35938,16,3.84375,15.6875,3.46875,15.4688,3,14.8125,3,17,3,18.0781,3.0625,18.3594,3.14063,18.6563,3.32813,18.8281,3.51563,19,4,19,4,20,0,20,0,19,0.15625,19,0.5,19.0156,0.75,18.7656,0.875,18.6406,0.9375,18.375,1,18.1094,1,17,1,11,1,9.79688,0.9375,9.46875,0.890625,9.14063,0.78125,9.01563,0.671875,8.875,0.46875,8.875,0.3125,8.875,0.078125,9,3,9.20313,3,12.3281,3,13.3438,3.07813,13.6719,3.20313,14.2031,3.67188,14.6094,4.15625,15,4.875,15,5.75,15,6.29688,14.2813,7,13.3594,7,11.6719,7,9.75,6.20313,8.71875,5.64063,8,4.875,8,4.45313,8,4.04688,8.21875,3.71875,8.39063,3,9.20313]),
    kernings: {}
  },
  's':
  {
    advanceHori: 8,
    commands: $.toIntVector([1,2,2,3,3,3,3,3,3,2,3,3,3,3,3,3,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3]),
    paths: $.toNumberVector([7,7,7,10,6,10,5.625,8.84375,5.03125,8.42188,4.45313,8,3.54688,8,2.84375,8,2.42188,8.3125,2,8.60938,2,8.96875,2,9.4375,2.375,9.76563,2.73438,10.0938,3.64063,10.4688,5.04688,11.0625,7,11.9688,7,13.4531,7,14.5938,6.1875,15.2969,5.39063,16,4.39063,16,3.6875,16,2.76563,15.25,2.48438,15,2.3125,15,2.10938,15,2,16,1,16,1,13,2,13,2.25,14,2.96875,14.5,3.6875,15,4.57813,15,5.20313,15,5.59375,14.7188,6,14.4219,6,14.0156,6,13.5313,5.3125,13.2031,4.625,12.8594,3.17188,12.2813,1.71875,11.6875,1.35938,11.1094,1,10.5313,1,9.65625,1,8.53125,1.73438,7.76563,2.48438,7,3.65625,7,4.17188,7,4.90625,7.60938,5.39063,8,5.5625,8,5.71875,8,5.79688,7.8125,5.89063,7.625,6,7]),
    kernings: {}
  },
  'u':
  {
    advanceHori: 9,
    commands: $.toIntVector([1,2,3,3,3,3,2,2,2,2,3,3,3,3,3,2,3,3,3,2,2,2,3,3,3,3,2,3,3,2]),
    paths: $.toNumberVector([8,7,8,12,8,13.3125,8.04688,13.6094,8.09375,13.9063,8.20313,14.0313,8.3125,14.1563,8.45313,14.1563,8.65625,14.1563,8.90625,14,9,15,6.42188,16,6,16,6,14.3125,4.92188,15.4219,4.34375,15.7188,3.78125,16,3.14063,16,2.4375,16,1.92188,15.6563,1.40625,15.2969,1.20313,14.75,1,14.2031,1,13.2031,1,10,1,9.07813,0.90625,8.73438,0.8125,8.375,0.640625,8.1875,0.46875,7.98438,0,8,0,7,3,7,3,12.9688,3,14.2188,3.34375,14.6094,3.70313,15,4.20313,15,4.54688,15,4.96875,14.7344,5.40625,14.4688,6,13.7344,6,10,6,8.84375,5.79688,8.4375,5.60938,8.03125,5,8,5,7]),
    kernings: {}
  },
  'd':
  {
    advanceHori: 10,
    commands: $.toIntVector([1,3,3,3,3,3,3,3,2,3,3,3,3,2,2,2,2,3,3,3,3,2,2,2,1,2,3,3,3,3,3,3,3,3]),
    paths: $.toNumberVector([7,14.3125,6.375,15.4531,5.78125,15.7344,5.1875,16,4.48438,16,3.09375,16,2.04688,14.8438,1,13.6719,1,11.8594,1,9.65625,2.15625,8.32813,3.3125,7,5.14063,7,6.26563,7,7,8.625,7,7,7,5.6875,6.95313,5.39063,6.90625,5.07813,6.79688,4.96875,6.6875,4.84375,6.53125,4.84375,6.35938,4.84375,6.07813,5,6,4,8.57813,3,9,3,9,12,9,13.3281,9.04688,13.625,9.09375,13.9063,9.20313,14.0313,9.3125,14.1563,9.45313,14.1563,9.64063,14.1563,9.92188,14,10,15,7.4375,16,7,16,7,13.7031,7,10.5781,6.95313,9.48438,6.6875,9,6.42188,8.5,5.98438,8.25,5.5625,8,5.15625,8,4.39063,8,3.79688,8.6875,3,9.59375,3,11.3438,2.875,13.125,3.70313,14.0625,4.53125,15,5.46875,15,6.26563,15,7,13.7031]),
    kernings: {}
  },
  'l':
  {
    advanceHori: 4,
    commands: $.toIntVector([1,2,3,3,3,2,2,2,3,3,3,2,3,3,3,3,2,2]),
    paths: $.toNumberVector([3,3,3,13,3,14,3.07813,14.3281,3.17188,14.6563,3.34375,14.8281,3.51563,15,4,15,4,16,0,16,0,15,0.46875,15,0.640625,14.8594,0.8125,14.7031,0.90625,14.3594,1,14,1,13,1,7,1,5.6875,0.953125,5.39063,0.90625,5.07813,0.796875,4.96875,0.703125,4.84375,0.546875,4.84375,0.375,4.84375,0.109375,5,0,4,2.57813,3]),
    kernings: {}
  },
  't':
  {
    advanceHori: 5,
    commands: $.toIntVector([1,2,2,2,2,2,3,3,3,3,2,3,3,3,3,3,2,2,2,3,3,3]),
    paths: $.toNumberVector([3,4,3,7,4.98438,7,4.98438,8,3,8,3,13.5781,3,14.4219,3.125,14.7188,3.25,15,3.45313,15,3.60938,15,3.76563,14.75,3.92188,14.5,4,14,5,14,4.65625,15,4.01563,15.5,3.39063,16,2.73438,16,2.28125,16,1.84375,15.7656,1.40625,15.5313,1.20313,15.0938,1,14.6406,1,13.7188,1,8,0,8,0,7.53125,0.390625,7.28125,0.78125,6.70313,1.1875,6.10938,1.51563,5.39063,1.6875,5,2,4]),
    kernings: {}
  },
  'a':
  {
    advanceHori: 8,
    commands: $.toIntVector([1,3,3,3,3,3,3,3,2,3,3,3,3,2,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,2,3,3,3,1,2,3,3,3,3,3,3]),
    paths: $.toNumberVector([5,14.6875,3.89063,15.6406,3.60938,15.7813,3.1875,16,2.70313,16,1.96875,16,1.48438,15.375,1,14.75,1,13.7344,1,13.0938,1.35938,12.625,1.5625,11.9688,2.35938,11.4063,3.15625,10.8281,5,10,5,9.73438,5,8.73438,4.71875,8.375,4.4375,8,3.89063,8,3.48438,8,3.23438,8.25,2.98438,8.51563,2.98438,8.84375,3,9.28125,3,9.625,2.71875,9.8125,2.4375,10,2,10,1.5625,10,1.28125,9.76563,1,9.51563,1,9.10938,1,8.32813,1.82813,7.67188,2.65625,7,4.14063,7,5.28125,7,6.01563,7.39063,6.5625,7.6875,6.82813,8.32813,7,8.73438,7,10.0156,7,12.9844,7,14.25,7.03125,14.5313,7.0625,14.8125,7.125,14.9063,7.20313,15,7.3125,15,7.40625,15,7.48438,14.9063,7.625,14.75,8,14,8,14.7031,6.95313,16,6,16,5.54688,16,5.28125,15.7031,5.01563,15.4063,5,14.6875,5,14.1094,5,11,4.10938,11.5313,3.85938,11.75,3.39063,12.1563,3.1875,12.5781,3,13,3,13.5156,3,14.1563,3.25,14.5781,3.5,15,3.82813,15,4.28125,15,5,14.1094]),
    kernings: {}
  },
  'c':
  {
    advanceHori: 9,
    commands: $.toIntVector([1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]),
    paths: $.toNumberVector([8,13.0625,7.42188,14.9688,6.3125,15.4844,5.20313,16,4.51563,16,3.10938,16,2.04688,14.7969,1,13.5781,1,11.5,1,9.5,2.20313,8.25,3.40625,7,5.09375,7,6.375,7,7.1875,7.70313,8,8.40625,8,9.15625,8,9.53125,7.78125,9.76563,7.57813,10,7.20313,10,6.70313,10,6.9375,9.6875,6.29688,9.5,6.25,9.01563,6.20313,8.51563,5.90625,8.25,5.60938,8,5.07813,8,4.21875,8,3.6875,8.59375,3,9.375,3,10.6719,3,11.9844,3.54688,13,4.10938,14,5.04688,14,5.71875,14,6.26563,14.2188,6.64063,14.0156,7,13]),
    kernings: {}
  },
  'n':
  {
    advanceHori: 9,
    commands: $.toIntVector([1,3,3,3,3,2,3,3,3,2,2,2,2,3,3,3,2,3,3,3,2,3,3,3,2,2,2,2,3,3,2,3,3,3,3,2,2,2]),
    paths: $.toNumberVector([3,8.6875,4.48438,7,5.82813,7,6.51563,7,7,7.3125,7.5,7.60938,7.79688,8.3125,8,8.79688,8,9.8125,8,13,8,14.0156,8.09375,14.375,8.17188,14.6719,8.34375,14.8438,8.53125,15,9,15,9,16,5,16,5,15,5.125,15,5.5625,15,5.73438,14.7813,5.90625,14.5469,5.96875,14.0938,6,13.9219,6,13,6,9.9375,6,8.92188,5.73438,8.46875,5.48438,8,4.875,8,3.9375,8,3,9.26563,3,13,3,14.0938,3.07813,14.3438,3.17188,14.6875,3.32813,14.8438,3.5,15,4,15,4,16,0,16,0,15,0.140625,15,0.640625,15,0.8125,14.5938,1,14.1719,1,13,1,11,1,9.67188,0.953125,9.39063,0.90625,9.09375,0.796875,8.98438,0.703125,8.85938,0.53125,8.85938,0.34375,8.85938,0.09375,9,0,8,2.59375,7,3,7]),
    kernings: {}
  },
  'g':
  {
    advanceHori: 9,
    commands: $.toIntVector([1,3,3,3,3,3,2,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,3,3,3,3,3,3,3,1,3,3,3,3,3,3,3,3,3]),
    paths: $.toNumberVector([2.6875,12.2031,1.875,11.8594,1.4375,11.2344,1,10.5938,1,9.84375,1,8.67188,1.95313,7.84375,2.92188,7,4.42188,7,5.65625,7,6.5625,8,8.375,8,8.78125,8,8.84375,8.03125,8.92188,8.0625,8.9375,8.125,9,8.21875,9,8.48438,9,8.76563,8.96875,8.875,8.9375,8.9375,8.875,8.96875,8.82813,9,8.48438,9,7.48438,9,8,9.57813,8,10.4844,8,11.5313,7.04688,12.2656,6.09375,13,4.5,13,3.84375,13,3.15625,12.5938,2.48438,12.9063,2.23438,13.1406,2,13.375,2,13.5469,2,13.6719,2.15625,13.8125,2.32813,13.9375,2.8125,14,3.10938,14,4.23438,14,6.3125,14,6.9375,14,7.875,14.1406,8.4375,14.7344,9,15.3281,9,16.2031,9,17.3906,7.95313,18.4531,6.42188,20,3.95313,20,2.04688,20,0.734375,19.2031,0,18.75,0,18.25,0,18.0313,0.140625,17.8125,0.34375,17.4844,1,16.875,1.07813,16.7969,2.25,15.8906,1.5625,15.5469,1.28125,15.2656,1,14.9844,1,14.6406,1,14.2344,1.29688,13.7031,1.59375,13.1719,2.6875,12.2031,4.39063,8,3.79688,8,3.39063,8.4375,3,8.85938,3,9.75,3,10.8906,3.54688,11.5156,3.96875,12,4.60938,12,5.21875,12,5.60938,11.5938,6,11.1719,6,10.2813,6,9.125,5.45313,8.48438,5.03125,8,4.39063,8,2.89063,16,1.95313,16.4688,1.46875,16.875,1,17.2969,1,17.6406,1,18.0938,1.57813,18.4219,2.57813,19,4.48438,19,6.28125,19,7.14063,18.3594,8,17.7188,8,17,8,16.4844,7.5625,16.2656,7.125,16.0469,5.82813,16,3.92188,16,2.89063,16]),
    kernings: {}
  }
};


var mainComp = MainComposition(
{
  width : 640,
  height : 480,

  layers :
  [
    DynamicVectorTextLayer(
    {
      font : tnrFontData,

      textProperties :
      {
        horizontalAlign : "center",
        verticalAlign : "center",
        fontSize : 14,
        text : KeyframesBind(
        {
          keyframes :
          [
            Keyframe({ time : 0, value : "Lorem ipsum dolor sit amet\nconsectetuer adipiscing elit", interpolation : Interpolation.hold }),
            Keyframe({ time : 30000, value : "tile gnicsipida reutetcesnoc\ntema tis rolod muspi meroL", interpolation : Interpolation.hold })
          ]
        }),

        letterSpacing : KeyframesBind(
        {
          keyframes :
          [
            Keyframe({ time : 0, value : 0 }),
            Keyframe({ time : 30000, value : 20 }),
            Keyframe({ time : 60000, value : 0 })
          ]
        })
      },

      inPoint : 0,
      outPoint : 60000,

      properties : 
      {
        x : 320,
        y : 240
      },

      animators :
      [
        Animator(
        {
          selector : RangeSelector(
          {
            shapingFunc : RangeShape.triangle,
            properties :
            {
              start : 0,
              end : 4,

              // Playing with offset to have the triangle "pass through" the string.
              offset : KeyframesBind(
              {
                keyframes :
                [
                  Keyframe({ time : 0, value : 1 }),
                  Keyframe({ time : 60000, value : -4 })
                ]
              })
            }
          }),
          bindings :
          {
            x : 100,
            y : -100,
            z : 250,

            rotationX : 1440,
            rotationY : -720,
            rotationZ : 360
          }
        })
      ]
    })
  ]
});

Akari.execute( mainComp );